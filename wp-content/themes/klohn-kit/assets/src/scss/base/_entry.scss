// assets/src/scss/base/_entry.scss

/* ---------------------------
   Title + Meta (dense, old-site, dotted separators)
--------------------------- */

.entry-title {
  font-size: var(--fs-h1);
  line-height: 1.1;
  margin: var(--space-l) auto var(--space-m);
  text-align: center;

  max-width: 100%;
}

.entry-meta {
  max-width: var(--prose-width);
  margin: 0 auto var(--space-l);
  padding: var(--space-s) 0;

  color: var(--color-muted);
  font-size: var(--fs-meta);
  line-height: var(--lh-meta);

  border-top: var(--border-meta);
  border-bottom: var(--border-meta);

  display: flex;
  flex-wrap: wrap;
  align-items: center;
}

.entry-meta__sep {
  margin: 0 var(--space-s);
  opacity: 0.9;
}

.entry-meta__author {
  display: inline-flex;
  align-items: center;
  gap: var(--space-s);
  min-width: 0;
}

.entry-meta__avatar {
  width: var(--space-xl);
  height: var(--space-xl);
  border-radius: 999px;
  display: block;
}

.entry-meta__author-name {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.entry-meta a {
  color: inherit;
  text-decoration: none;

  &:hover,
  &:focus-visible {
    text-decoration: underline;
    text-underline-offset: 2px;
  }
}

/* ---------------------------
   Entry content layout rules
   - Text stays in prose column
   - Media can use full container width
--------------------------- */

.entry-content {
  /* consistent vertical rhythm */
  > * {
    margin: 0 0 var(--space-m);
  }

  > :last-child {
    margin-bottom: 0;
  }

  /* 1) Text blocks: limit to prose width and center */
  :where(
    p, h1, h2, h3, h4, h5, h6,
    ul, ol, dl,
    blockquote, pre,
    table
  ) {
    max-width: var(--prose-width);
    margin-left: auto;
    margin-right: auto;
  }

  /* 2) Media blocks: stay full width (within the site container) */
  :where(
    figure,
    .wp-block-image,
    .wp-block-gallery,
    .wp-block-video,
    .wp-block-embed,
    .wp-block-cover,
    .gallery,
    .tiled-gallery
  ) {
    max-width: none;
    width: 100%;
    margin-left: auto;
    margin-right: auto;
  }

  /* 3) Classic-editor images often come as <p><img></p> — make those break out */
  p > img[class*="wp-image-"]:not(.alignleft):not(.alignright),
  p > a > img[class*="wp-image-"]:not(.alignleft):not(.alignright) {
    display: block;
    max-width: none;

    /* span full “container inner width” without relying on SCSS math */
    width: min(
            calc(100vw - var(--container-pad-x) - var(--container-pad-x)),
            calc(var(--container-max) - var(--container-pad-x) - var(--container-pad-x))
    );

    margin-left: 50%;
    transform: translateX(-50%);
  }

  /* 4) Groups: keep padding tight */
  .wp-block-group.has-background {
    padding: var(--space-xs);
  }

  .wp-block-group:not(.has-background) {
    padding: 0;
  }

  .wp-block-group.has-background > :first-child,
  .wp-block-group.has-background > .wp-block-group__inner-container > :first-child {
    margin-top: 0;
  }

  .wp-block-group.has-background > :last-child,
  .wp-block-group.has-background > .wp-block-group__inner-container > :last-child {
    margin-bottom: 0;
  }

  /* 5) Floats (keep current behavior) */
  .alignleft,
  img.alignleft,
  figure.alignleft {
    float: left;
    width: auto;
    max-width: none;
    transform: none;
    margin: 0 var(--space-l) var(--space-m) 0;
  }

  .alignright,
  img.alignright,
  figure.alignright {
    float: right;
    width: auto;
    max-width: none;
    transform: none;
    margin: 0 0 var(--space-m) var(--space-l);
  }

  /* Clear floats at the end of content */
  &::after {
    content: "";
    display: block;
    clear: both;
  }
}

/* Latest posts block should not be constrained */
.entry-content :where(ul, ol).wp-block-latest-posts,
.entry-content .wp-block-latest-posts__list {
  max-width: none;
}
