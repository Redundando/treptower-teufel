(()=>{function m(){const s=document.getElementById("site-header");if(!s)return;const o=s.querySelector(".nav-toggle");if(!o)return;const g=o.getAttribute("aria-controls"),b=g?document.getElementById(g):null;if(!b)return;const p=b.querySelector(".primary-menu");if(!p)return;const y=()=>window.getComputedStyle(o).display!=="none";function v(e){return e.querySelector(".submenu-toggle")}function i(e,n){e.classList.toggle("submenu-open",n);const r=v(e);r&&r.setAttribute("aria-expanded",String(n))}function c(e){s.querySelectorAll(".primary-menu li.submenu-open").forEach(n=>{e&&n===e||i(n,!1)})}function A(){c(null)}function E(e,n){const r=Array.from(e.children),d=r.find(a=>a.tagName==="A"),u=r.find(a=>a.tagName==="UL");if(!d||!u)return;u.id||(u.id=`submenu-${n}`);let t=v(e);t||(t=document.createElement("button"),t.type="button",t.className="submenu-toggle",t.setAttribute("aria-controls",u.id),t.setAttribute("aria-expanded","false"),t.setAttribute("aria-label","Toggle submenu"),t.innerHTML='<span class="submenu-toggle__icon" aria-hidden="true"></span>',d.insertAdjacentElement("afterend",t),t.addEventListener("click",a=>{if(!y())return;a.preventDefault(),a.stopPropagation();const f=!e.classList.contains("submenu-open");f&&c(e),i(e,f)}),d.addEventListener("click",a=>{if(!y())return;e.classList.contains("submenu-open")||(a.preventDefault(),c(e),i(e,!0))})),i(e,!1)}Array.from(p.querySelectorAll("li.menu-item-has-children")).forEach((e,n)=>{E(e,n)});function l(e){s.classList.toggle("nav-open",e),o.setAttribute("aria-expanded",String(e)),e||A()}o.addEventListener("click",()=>{const e=s.classList.contains("nav-open");l(!e)}),document.addEventListener("keydown",e=>{e.key==="Escape"&&s.classList.contains("nav-open")&&(l(!1),o.focus())}),document.addEventListener("click",e=>{if(!s.classList.contains("nav-open"))return;const n=e.target;n instanceof Node&&!s.contains(n)&&l(!1)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",m):m()})();
